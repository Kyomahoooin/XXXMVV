<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>chiomaoin</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background-color: #000000;
      position: relative;
    }

    img {
      width: 170px;
      height: auto;
      display: block;
      margin: 10px 0;
    }

    .my-jam, .playlist, .rotate-continuous {
      text-align: center;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    #audio-player {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #000;
      border-radius: 50%;
      z-index: 10;
    }

    #audio-player audio {
      width: 170px;
    }
  </style>
  <!-- Integrazione di GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      let imagesHidden = false;
      let rotationAnimation;
      let transformedImageRotation;

      // Animazione di ingresso per tutte le immagini
      gsap.from("img", {
        y: -50,
        opacity: 0,
        duration: 1,
        stagger: 0.3
      });

      // Rotazione continua per l'ultima immagine
      rotationAnimation = gsap.to(".rotate-continuous img", {
        rotation: 360,
        duration: 5,
        repeat: -1,
        ease: "linear"
      });

      // Funzione per gestire il click sull'ultima immagine
      document.querySelector(".rotate-continuous").addEventListener("click", () => {
        const imgElement = document.querySelector(".rotate-continuous img");
        const audioPlayer = document.getElementById("audio-player");
        const audioElement = document.querySelector("#audio-player audio");

        if (!imagesHidden) {
          // Nascondere le altre immagini
          gsap.to(".my-jam", {
            x: -300,
            opacity: 0,
            duration: 1,
            ease: "power2.out"
          });

          gsap.to(".playlist", {
            x: 300,
            opacity: 0,
            duration: 1,
            ease: "power2.out"
          });

          // Continuare a ruotare e trasformare durante la dissolvenza
          gsap.to(imgElement, {
            opacity: 0,
            duration: 1,
            onComplete: () => {
              imgElement.src = "https://res.cloudinary.com/dfbo3wljq/image/upload/v1737311135/CD13-375x375-1_lpuvkr.png";

              // Ferma la rotazione e resetta
              rotationAnimation.pause();
              gsap.fromTo(imgElement, { rotation: 0, opacity: 0 }, { opacity: 1, duration: 1 });

              // Mostra il lettore audio con animazione sincronizzata
              audioPlayer.style.display = "block";
              gsap.fromTo(audioPlayer, 
                { opacity: 0, scale: 0, rotation: -180 },
                { opacity: 1, scale: 1, rotation: 0, duration: 1, ease: "back.out(1.7)" }
              );
            }
          });
        } else {
          // Ferma l'audio e nascondi il lettore
          audioElement.pause();
          audioElement.currentTime = 0; // Reset dell'audio

          gsap.to(audioPlayer, {
            opacity: 0,
            scale: 0,
            rotation: -180,
            duration: 0.5,
            ease: "back.in(1.7)",
            onComplete: () => {
              audioPlayer.style.display = "none";
            }
          });

          gsap.to(imgElement, {
            opacity: 0,
            duration: 1,
            onComplete: () => {
              imgElement.src = "https://res.cloudinary.com/dfbo3wljq/image/upload/v1737244690/CD13-375x375-1_vh6v1w.png";

              // Riprendi la rotazione
              rotationAnimation = gsap.to(imgElement, {
                rotation: 360,
                duration: 5,
                repeat: -1,
                ease: "linear"
              });

              gsap.fromTo(imgElement, { opacity: 0 }, { opacity: 1, duration: 1 });

              // Ritorno delle altre immagini
              gsap.to(".my-jam", {
                x: 0,
                opacity: 1,
                duration: 1,
                ease: "power2.inOut"
              });

              gsap.to(".playlist", {
                x: 0,
                opacity: 1,
                duration: 1,
                ease: "power2.inOut"
              });
            }
          });
        }

        imagesHidden = !imagesHidden; // Alterna lo stato delle immagini
      });

      // Gestisci la rotazione continua dell'immagine trasformata in base al lettore audio
      const audioElement = document.querySelector("#audio-player audio");
      audioElement.addEventListener("play", () => {
        const transformedImg = document.querySelector(".rotate-continuous img");
        transformedImageRotation = gsap.to(transformedImg, {
          rotation: 360,
          duration: 5,
          repeat: -1,
          ease: "linear"
        });
      });

      audioElement.addEventListener("pause", () => {
        if (transformedImageRotation) {
          transformedImageRotation.pause();
        }
      });
    });
  </script>
</head>
<body>

  <!-- Immagine superiore -->
  <p class="my-jam">
    <a href="https://steamcommunity.com/profiles/76561199396357317/">
      <img src="https://res.cloudinary.com/dfbo3wljq/image/upload/v1737244691/steam_iemg5r.png" alt="Steam">
    </a>
  </p>
  
  <!-- Immagine al posto di .Wav -->
  <p class="playlist">
    <a href="https://open.spotify.com/user/31gms4uvuxayraivbxo4tttpasmm?si=d933ebaee5804c26">
      <img src="https://res.cloudinary.com/dfbo3wljq/image/upload/v1737244769/50K_VINYL_MOCKUP_byns57.png" alt=".Wav">
    </a>
  </p>

  <!-- Immagine con rotazione continua -->
  <p class="rotate-continuous">
    <a href="#">
      <img src="https://res.cloudinary.com/dfbo3wljq/image/upload/v1737244690/CD13-375x375-1_vh6v1w.png" alt="Playlist Image">
    </a>
  </p>

  <!-- Lettore audio -->
  <div id="audio-player">
    <audio controls>
      <source src="https://res.cloudinary.com/dfbo3wljq/video/upload/v1737290250/PLAY_THIS_owbyag.mp3" type="audio/mpeg">
      Il tuo browser non supporta il lettore audio.
    </audio>
  </div>

</body>
</html>
